# Tests for Utility Functions

test.proc_line <- function() {
  test_line <- "1241160900 109513 0 |user 2:0.000012 3:0.000000 4:0.000006 5:0.000023 6:0.999958 1:1.000000 |109498 2:0.306008 3:0.000450 4:0.077048 5:0.230439 6:0.386055 1:1.000000 |109509 2:0.306008 3:0.000450 4:0.077048 5:0.230439 6:0.386055 1:1.000000 |109508 2:0.264355 3:0.000012 4:0.037393 5:0.420649 6:0.277591 1:1.000000 |109473 2:0.295442 3:0.000014 4:0.135191 5:0.292304 6:0.277050 1:1.000000 |109503 2:0.306008 3:0.000450 4:0.077048 5:0.230439 6:0.386055 1:1.000000 |109502 2:0.277121 3:0.000131 4:0.038153 5:0.335835 6:0.348760 1:1.000000 |109501 2:0.249086 3:0.001009 4:0.514682 5:0.067732 6:0.167491 1:1.000000 |109492 2:0.331830 3:0.000022 4:0.019904 5:0.440390 6:0.207855 1:1.000000 |109495 2:0.313277 3:0.000125 4:0.018413 5:0.410555 6:0.257630 1:1.000000 |109494 2:0.306008 3:0.000450 4:0.077048 5:0.230439 6:0.386055 1:1.000000 |109484 2:0.438513 3:0.000003 4:0.030714 5:0.384494 6:0.146277 1:1.000000 |109506 2:0.264355 3:0.000012 4:0.037393 5:0.420649 6:0.277591 1:1.000000 |109510 2:0.287909 3:0.000025 4:0.008983 5:0.511333 6:0.191751 1:1.000000 |109514 2:0.297750 3:0.000013 4:0.011603 5:0.512182 6:0.178452 1:1.000000 |109505 2:0.375829 3:0.000025 4:0.033041 5:0.349637 6:0.241468 1:1.000000 |109515 2:0.281649 3:0.000173 4:0.195994 5:0.151003 6:0.371182 1:1.000000 |109512 2:0.297322 3:0.000025 4:0.034951 5:0.413566 6:0.254137 1:1.000000 |109513 2:0.211406 3:0.000036 4:0.002773 5:0.569886 6:0.215900 1:1.000000 |109511 2:0.381149 3:0.000129 4:0.060038 5:0.269129 6:0.289554 1:1.000000 |109453 2:0.421669 3:0.000011 4:0.010902 5:0.309585 6:0.257833 1:1.000000"
  expected <- "1241160900 109513 0 0.000012 0.000000 0.000006 0.000023 0.999958 1.000000 109498 0.306008 0.000450 0.077048 0.230439 0.386055 1.000000 109509 0.306008 0.000450 0.077048 0.230439 0.386055 1.000000 109508 0.264355 0.000012 0.037393 0.420649 0.277591 1.000000 109473 0.295442 0.000014 0.135191 0.292304 0.277050 1.000000 109503 0.306008 0.000450 0.077048 0.230439 0.386055 1.000000 109502 0.277121 0.000131 0.038153 0.335835 0.348760 1.000000 109501 0.249086 0.001009 0.514682 0.067732 0.167491 1.000000 109492 0.331830 0.000022 0.019904 0.440390 0.207855 1.000000 109495 0.313277 0.000125 0.018413 0.410555 0.257630 1.000000 109494 0.306008 0.000450 0.077048 0.230439 0.386055 1.000000 109484 0.438513 0.000003 0.030714 0.384494 0.146277 1.000000 109506 0.264355 0.000012 0.037393 0.420649 0.277591 1.000000 109510 0.287909 0.000025 0.008983 0.511333 0.191751 1.000000 109514 0.297750 0.000013 0.011603 0.512182 0.178452 1.000000 109505 0.375829 0.000025 0.033041 0.349637 0.241468 1.000000 109515 0.281649 0.000173 0.195994 0.151003 0.371182 1.000000 109512 0.297322 0.000025 0.034951 0.413566 0.254137 1.000000 109513 0.211406 0.000036 0.002773 0.569886 0.215900 1.000000 109511 0.381149 0.000129 0.060038 0.269129 0.289554 1.000000 109453 0.421669 0.000011 0.010902 0.309585 0.257833 1.000000"
  results <- proc_line(test_line)
  
  checkEquals(results, expected)
}